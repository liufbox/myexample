﻿#问题描述   今天把windows10修改为了使用microsoft 账号登录，可能是由于国内网络问题，锁屏后登录一直超时白屏、提示没有连接Internet。因没有建立本地其他账号，导致无法登录windows。尝试使用安全模式，无法打开系统设置功能，无法关闭使用microsoft账号登录。系统无法正常登录。---------#解决思路 在windows登录界面，连续按5次shift键，windows会调用Windows的粘滞键，对应程序为C:\Windows\System32\sethc.exe。尝试使用cmd.exe替换为该程序，在登录界面连续按5次shift就可以调用cmd.exe，进而可以执行mmc.exe，添加新用户，使用新用户登录。新用户登录后，修改默认dns后，再切换会microsoft账号登录，即可以成功登录系统。   -------#解决步骤  1. 首先进入带命令的安全模式。2. 在命令行安全模式下，依次执行命令:  `REN  sethc.exe  sethc_bak.exe`    `copy cmd.exe sethc.exe`3. 重启进入正常登录界面，连续按5次shift键，就会弹出命令行窗口。4. 在命令窗口执行mmc，打开管理控制台 `mmc.exe`5. 在管理控制台，打开"文件--添加/删除管理单元"，添加“本地用户和组”，确定。然后使用“本地用户和组”添加一个新用户，为新用户添加Administrators组权限。6. 在登录界面左下角可以看到新用户，使用新用户登录系统，修改网络DNS为"4.4.4.2"，然后切换为原microsoft用户登录，就可以弹出登录框、输入密码，正常登录了。登录后记得使用PIN密码登录，以后登录就不会需要连接云端微软服务器了。    可用DNS可用通过搜索引擎获取，具体哪个DNS好用，估计跟自己网络相关。#后续思考   关闭使用microsoft登录或修改dns设置，需要先登录才能设置，条件和结果循环依赖，问题似乎无解。通过修改一个无需登录可以执行命令，创建了新用户，从而实现了登录等操作。   1. 从解决问题角度来说，问题解决需要发散式的思路，从需要的结果找办法，比如怎么在没登录情况下设置dns等。2. 从设计一个安全系统来说，怎么避免一个漏洞，让攻击者可以绕过整个安全设施，需要进一步思考。    